# <center>数字签名算法(DSA)</center>
 


<div style="text-align: right;">孙自翔 </div> 
<div style="text-align: right;">haichengsun123@163.com</div> 

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

**写在前面**: 数字签名算法(DSA)是原始的Elgamal数字签名算法的变体，Elgamal数字签名算法是基于离散对数公钥密码体系的算法。本文旨在不引入`群论`的情况下，在所介绍的离散对数相关概念(阶，原根)等概念的基础上，用朴素的数论知识阐述Elgamal和DSA数字签名算法.本文既能充分阐述算法所需要的数学知识，又不拘泥于细节；既能阐述其推导过程，又不过分扩展无关知识。非常适合程序员或公钥加密算法爱好者阅读。
   
 


<!--
这里是注释显示不出来
{\rm 需转换的部分字符}
$$ evidence\_{i}=\sum \_{j}W\_{ij}x\_{j}+b\_{i} $$
其中，\\( W\_i \\) 和 \\( b\_i \\) 分别为类别 \\( i \\) 的权值和偏置。
\\( {\cal  K}   {\rm A}   \alpha　A　\beta　B　\gamma　\Gamma　\delta　\Delta　\epsilon　E \varepsilon　　\zeta　Z　\eta　H　\theta　\Theta　\vartheta \iota　I　\kappa　K　\lambda　\Lambda　\mu　M　\nu　N \xi　\Xi　o　O　\pi　\Pi　\varpi　　\rho　P \varrho　　\sigma　\Sigma　\varsigma　　\tau　T　\upsilon　\Upsilon \phi　\Phi　\varphi　　\chi　X　\psi　\Psi　\omega　\Omega  \\))
\\({\cal K} {\sf K}\\)
\\[\alpha\\]    
\in 
a^b
--> 
## 1. 概述  
<!-- <ol>  加上这里 一级标题不能对齐-->

### 1.1 离散对数问题（\\(DLP\\)）
DSA签名算法所依赖的数学根基为**离散**对数问题，先阐述如下，本篇文章即围绕此定义展开。     

**定义** 假设\\(m\\)是一个有原根\\(r\\)的正整数。如果正整数\\(a\\)满足\\((a,m)=1\\),则使得同余式   
$$r^x \equiv  a \ \ mod \ m \ \ \  ( 1 \le x \le \varphi(m) )$$
成立的唯一整数\\(x\\)称为**\\(a对模m的以r为底的指数\\)**或者叫**离散对数**，并且记为\\(ind\_{r}a\\),此处并未标明\\(m\\),因为我们假定其取定值。
    
**说明** 定义中的\\(m\\)不一定为素数，而且如果定义中\\(r\\)非`原根`而仅仅是普通的`阶`,会是什么情况。        
面对此定义及说明，我们自然有如下问题:    
1. 什么是`阶`?  
2. 什么是`原根`?   
3. 为什么一定有满足上述定义的\\(x\\)存在，且唯一? 
   
本文的目的就是为了清晰的阐述这一定义。 并在此基础上阐述Elgamal数字签名算法和DSA数字签名算法。  
 

### 1.2 了解`原根`等相关知识的必要性

上述定义已经展示，要理解此定义及证明\\(x\\)的存在性，必须了解原根等相关知识。


### 1.3 是否一定要了解`群论`相关知识    
只了解数论相关知识，而不了解群论，一样可以把Elgamal加密算法和DSA数字签名算法（DSA）阐述清楚。 当然如果了解群论，对于问题的描述更加便捷，但本文使用`集合`而非`群论`中的概念来描述。   

****

## 2. 原根
 
介绍`原根`，需要先介绍`阶`的概念，从而需要先复习下`欧拉定理`，重述如下:
### 2.1 欧拉定理      
**定义** 设\\(n\\)是一个正整数，**欧拉\\(\varphi函数\varphi(n)\\)**定义为不超过\\(n\\)且与\\(n\\)互素的正整数的个数。
<center> 欧拉函数\\(\varphi(n)\\)的值， \\(1\leq n \leq 12\\)  </center>  

|               n|   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|\\(\varphi(n)\\)|   1|   1|   2|   2 |   4|   2|   6|   4|   6|   4|  10|   4|


**欧拉定理** 设\\(m\\)是一个正整数，\\(a\\)是一个整数且\\((a,m)=1\\),那么\\(a^{\varphi(m)}\equiv 1(mod\ m)\\)  
**证明** 参考《初等数论及其应用》

**一点说明**
> \\(这里的a和m不要求为素数，只要满足(a,m)=1\\)
> 而费马小定理则要求模数是素数.
>

**举例说明**

>\\(令a = 4， m = 9，满足(a,m)=1且\varphi(9)=6\\)       
>此时有
>\\(a^{\varphi(m)} =4^{6}=4096 \equiv 1(mod \ 9)\\)


可以利用欧拉定理来找寻模m的逆，若\\(a\\)和\\(m\\)互素则，
$$a \cdot a^{\varphi(m)-1}=a^{\varphi(m)}\equiv 1(mod\ m)$$
因此，\\(a^{\varphi(m)-1}\\) 是\\(a\\)模\\(m\\)的逆。

**举例说明**
> 
> \\(7x \equiv 1(mod\ 10)，求x\\)    
> \\(令a=7，m=10，此时有(a,m)=1，\varphi(m)=\varphi(10)=4，所以\\)    
> \\(7模10的逆为7^{\varphi(10)-1}=7^{3}=343\equiv 3(mod\ 10)\\)    
> \\(所以7模10的逆x\equiv 3(mod10)\\)

**结论** 结合模的逆和欧拉定理,我们有如下结论    
> \\(若a\_{1},a\_{2}...a\_{k}...是a模m的逆，则有\\)
> \\(a^{\varphi(m)-1}\equiv \overline{a}\equiv a^{-1}\equiv a\_{1} \equiv a\_{2}\equiv...\equiv a\_{k}\equiv...(mod\ m)\\)
> \\(而且只有与\overline{a}模m同余的这些整数才是a模m的逆\\)

后面我们统一用\\(\overline{a}\\)记为\\(a模m\\)的逆。 

### 2.2 整数的阶
**定义** 设\\(a\\)和 \\(n\\)是互素的整数，\\(a \not=0,n>0  \\).使得\\(a^x \equiv 1 (mod \  n)\\)成立的最小正整数\\(x\\)称为\\(a模n的阶\\)，并记为\\(ord\_{n}a\\).   
      
**说明:** 根据欧拉定理，如果\\(n\\)为正整数且\\(a\\)是一个和\\(n\\)互素的整数，那么\\(a^{\varphi(n)}\equiv 1(mod\ n)\\)，因此至少存在一个整数\\(x\\)满足这个同余方程.所以存在一个最小的正整数\\(x\\)满足这个同余方程\\(a^x \equiv 1 (mod \ n)\\)，故有如上定义。   

      
**示例1:**  为求出2模7的阶，我们计算2的各次幂模7的最小正剩余，有：
         $$2^1 \equiv 2 (mod \ 7)$$
         $$2^2 \equiv 4 (mod \ 7)$$
         $$2^3 \equiv 1 (mod \ 7)$$
         因此有\\(ord\_{7}2 =3\\), 注意此时 \\(ord\_{7}2 < \varphi(7)=6\\),    
    
**示例2:** 为求出3模7的阶，我们计算3的各次幂模7的最小正剩余，有：      
         
 
|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$3^k(mod \ 7)$$|   3|   2|   6|   4 |   5|   1|   3|   2|   6|   4|  5|   1|


 因此有\\(ord\_{7}3 =6\\), 注意此时 \\(ord\_{7}3 = \varphi(7)=6\\),  
         所以并不总是有    \\(ord\_{n}a = \varphi(n)\\), 跟 \\(a\\)的具体值有关.      
                    
**说明**  给特定一个整数\\(n\\), 我们对模\\(n\\)阶为\\(\varphi(n)\\)的整数\\(a\\)感兴趣，也即模\\(n\\)的最大可能阶(\\(ord\_{n}a = \varphi(n)\\))。从而引出原根的定义。          
### 2.3 原根  
**定义2.3.1** 如果\\(r\\)和 \\(n\\)是互素的整数，且\\(n>0  \\).那么当\\(ord\_{n}a = \varphi(n)\\)时，称\\(r\\)是**模\\(n\\)的原根**或者**\\(n\\)的原根**  
**说明** 原根的定义之所以重要，是因为原根有着很好的性质，特别是当\\(n\\)为素数时。现在先不加证明的给出什么样的正整数存在原根，随后给出若干原根的例子，再给出关于原根的若干定理。 
 
**定理2.3.1** 正整数\\(n(n>1)\\)有原根当且仅当     
     $$n=2,4,p^t或者2p^t$$
     其中\\(p\\)为奇素数且\\(t\\)是正整数.      
**说明**  由此定理可知，在前30个数中，有原根的数为    
$$2,3,4,5,6,7,9,10,11,13,14,17,18,19,22,23,25,26,27,29$$
我们只说明这些正整数有原根，但是没有给出原根是什么。下面给出几个原根示例。    
**示例1** 10有原根，原根必然和10互素，可能为3,7,9，且\\(\varphi(10)=4\\),计算如下    

**$$r=3时$$**       


|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$3^k(mod\ 10)$$|   3|   9|   7|    1|   3|   9|   7|   1|   3|   9|  7|   1|



可以看出\\(ord\_{10}3=4=\varphi(10)\\)),所以3是10的原根,且其`余数`是循环的，集合为{3,9,7,1}，构成了模10的既约剩余系。
**$$r=7时$$**     

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$7^k(mod\ 10)$$|   7|   9|   3|    1|   7|   9|   3|   1|   7|   9|  3|   1|

可以看出\\(ord\_{10}7=4=\varphi(10)\\)),所以7是10的原根,且其`余数`是循环的，集合为{3,9,7,1}，构成了模10的既约剩余系。

**$$r=9时$$**      

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$9^k(mod\ 10)$$|   9|   1|   9|    1|   9|   1|   9|   1|   9|   1|   9|   1|

可以看出\\(ord\_{10}9=2\not=\varphi(10)\\)),所以9不是10的原根.    
所以10的原根只有2个{3,7}, 个数\\(2=\varphi(\varphi(10))=\varphi(4)\\)


**示例2** 素数7有原根，原根必然和7互素，可能为2,3,4,5,6, 且\\(\varphi(7)=6\\),计算如下    

**$$r=2时$$**      


|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$2^k(mod\ 7)$$ |   2|   4|   1|    2|   4|   1|   2|   4|   1|   2|   4|   1|


可以看出\\(ord\_{7}2=3\not=\varphi(7)\\)),所以2不是7的原根。虽然如此,其余数仍然是循环的，集合为\\(\\{1,2,4\\}\\)

**$$r=3时$$**  


|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$3^k(mod\ 7)$$ |   3|   2|   6|    4|   5|   1|   3|   2|   6|   4|   5|   1|


可以看出\\(ord\_{7}3=6=\varphi(7)\\)),所以3是7的原根,且其`余数`是循环的，集合为{3,2,6,4,5,1}，构成了模7的既约剩余系。

**$$r=4时$$**  


|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$4^k(mod\ 7)$$ |   4|   2|   1|    4|   2|   1|   4|   2|   1|   4|   2|   1|

可以看出\\(ord\_{7}4=3\not=\varphi(7)\\)),所以4不是7的原根,其余数集合为\\(\\{4,2,1\\}\\) 
**$$r=5时$$**  



|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$5^k(mod\ 7)$$ |   5|   4|   6|    2|   3|   1|   5|   4|   6|   2|   3|   1|


可以看出\\(ord\_{7}3=6=\varphi(7)\\)),所以5是7的原根,且其`余数`是循环的，集合为{5,4,6,2,3,1}，构成了模7的既约剩余系。

**$$r=6时$$** 

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$6^k(mod\ 7)$$ |   6|   1|   6|    1|   6|   1|   6|   1|   6|   1|   6|   1|


可以看出\\(ord\_{7}6=2\not=\varphi(7)\\)),所以6不是7的原根,其余数集合为\\(\\{6,1\\}\\)   
  
所以7的原根有2个{3,5}, 个数\\(2=\varphi(\varphi(7))=\varphi(6)\\)
****

## 3. 原根的性质
**定理3.1** 如果\\(r\\)和 \\(n\\)是互素的正整数，且\\(n>0  \\).则如果\\(r\\)是**模\\(n\\)**的一个原根，那么下列整数     
$$r^1,r^2,...,r^{\varphi(n)}$$     
构成了模\\(n\\)的既约剩余系.        
**说明** 上面给出10和7的原根的计算过程，已经诠释了这一定理。重述如下：        
\\(ord\_{10}3=4=\varphi(10)\\)),3是10的原根,且其`余数`是循环的，集合为{3,9,7,1}，构成了模10的既约剩余系。       
\\(ord\_{10}7=4=\varphi(10)\\)),7是10的原根,且其`余数`是循环的，集合为{3,9,7,1}，构成了模10的既约剩余系。


\\(ord\_{7}3=6=\varphi(7)\\)),3是7的原根,且其`余数`是循环的，集合{3,2,6,4,5,1}，构成了模7的既约剩余系。
\\(ord\_{7}3=6=\varphi(7)\\)),5是7的原根,且其`余数`是循环的，集合{5,4,6,2,3,1}，构成了模7的既约剩余系。
    
这其实是一个包含了\\(\varphi(n)\\)个元素的集合，且是循环的.

**定理3.2** 如果正整数 \\(n\\)有一个原根，那么它一共有\\(\varphi(\varphi(n))\\)个不同的原根。     
这个定理不是本文所关注的，是一个附加定理，可以忽略。     


**说明** 上面给出10和7的原根的计算过程，已经诠释了这一定理。重述如下：        
10的原根有2个{3,7}, 个数\\(2=\varphi(\varphi(10))=\varphi(4)\\)    
7的原根有2个{3,5}, 个数\\(2=\varphi(\varphi(7))=\varphi(6)\\)  

到此为止，我们已经可以充分理解文章开头给出的离散对数的定义中给出的前三个问题。也能完全阐述清楚Elgamal签名算法的原理，但是工程在用的DSA算法是Elgamal签名算法的扩展，涉及到`阶`的相关性质。

   
## 4. 阶的相关性质

在上文中计算10的原根的过程中，发现并非所有和10互素的数{3,7,9}都是10的原根，那么非原根的那些数字有什么特点呢，这里为后面`阶`的性质做铺垫。    
以\\(n=11\\)为例计算原根，进一步巩固前面的知识,并且观察研究不是原根的这些数字的特点。
$$r=2$$   

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$2^k(mod\ 11)$$ |   2|   4|   8|    5|   10|   9|   7|   3|   6|   2|   4|   8|

$$r=3$$    

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$3^k(mod\ 11)$$ |   3|   9|   5|    4|   1|   3|   9|   5|   4|   1|   3|   9|


$$r=4$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$4^k(mod\ 11)$$ |   4|   5|   9|    3|   1|   4|   5|   9|   3|   1|   4|   5|


$$r=5$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$5^k(mod\ 11)$$ |   5|   3|   4|    9|   1|   5|   3|   4|   9|   1|   5|   3|

$$r=6$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$6^k(mod\ 11)$$ |   6|   3|   7|    9|   10|   5|   8|   4|   2|   6|   3|   7|

$$r=7$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$7^k(mod\ 11)$$ |   7|   5|   2|    3|   10|   4|   6|   9|   8|   7|   5|   2|

$$r=8$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$8^k(mod\ 11)$$ |   8|   9|   6|    4|   10|   3|   2|   5|   7|   1|   8|   9|

$$r=9$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$9^k(mod\ 11)$$ |   9|   4|   3|    5|   1|   9|   4|   3|   5|   1|   9|   4|

$$r=10$$

|  \\(k\\)       |   1|   2|   3|   4 |   5|   6|   7|   8|   9|  10|  11|  12|
|            :--:|:--:|:--:|:--:| :--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|$$10^k(mod\ 11)$$ |   10|   1|   10|    1|   10|   1|   10|   1|   10|   1|   10|   1|


**总结如下**    
**1.** 11的原根有\\(\varphi(\varphi(11))=\varphi(10)=4\\)个，分别为\\(2,6,7,8\\),原根又叫做生成元，每个生成元都可以生成\\(\varphi(11)=10\\)个元素，这些元素\\(\\{1,2,3,4,5,6,7,8,9,10\\}\\)构成了模11的既约剩余系。    
**2.** 剩余的和11互素的数\\(\\{3,4,5,9,10\\}\\)都不是11的原根。我们以9和10作为例子观察。    
**3.** 当\\(r=9\\)时         
\\(9^5 \equiv 1 mod 11=> ord\_{11}9=5\\),也就是9模11的阶为5，此时由\\(r=9模11\\)生成的数为一个集合，集合的个数为\\(ord\_{11}9=5\\)，分别为\\(\\{1,3,4,5,9\\}\\)        
**4.** 当\\(r=10\\)时        
\\(10^2 \equiv 1 mod 11=> ord\_{11}10=2\\),也就是10模11的阶为2，此时由\\(r=10模11\\)生成的数为一个集合，集合的个数为\\(ord\_{11}10=2\\)，分别为\\(\\{1,10\\}\\)  
**5.** 由模11的阶生成的集合的个数只可能为\\(2，5，10\\),恰好等于阶的的大小，且都能被\\(\varphi(11)=10\\)整除. 

    
结合以上总结，给出`阶`的若干性质。

**定理4.1** 如果 \\(a\\)和\\(n\\)是互素的整数，且\\(n>0\\)，那么\\(ord_{n}a|\varphi(n)\\)。     
**说明** 对照上面的例子当\\(n=11\\)时\\(\varphi(11)=10\\),被10整除的数只有\\(\\{2,5,10\\}\\),所以模11的`阶`\\(ord\_{n} r=s\\)只可能为\\(\\{2,5,10\\}\\)，且每个数\\(r\\)都生成了\\(ord\_{n} r=s\\)个数,符合预期。 可以总结为  
**$$满足ord\_{n}r=s的数r生成了s个数,也就是阶为s则生成的数的集合个数也是s$$**


以\\(n=11\\)重述如下：    
**1.** \\(ord\_{11}2=10\\)，\\(r=2\\)时阶为10，生成的元素个数也是10，分别为\\(\\{1,2,3,4,5,6,7,8,9\\}\\)        
**2.** \\(ord\_{11}9=5\\)，\\(r=9\\)时阶为5，生成的元素个数也是5，分别为\\(\\{1,3,4,5,9\\}\\)              
**3.** \\(ord\_{11}10=2\\)，\\(r=10\\)时阶为2，生成的元素个数也是1，分别为\\(\\{1,10\\}\\) 

所以可以通过\\(\varphi(n)\\)找到\\(n\\)的所有的阶，均为\\(\varphi(n)\\)的因子。 


**定理4.2** 如果\\(a\\)和\\(n\\)是互素的整数，且\\(n>0\\)，那么\\(a^i \equiv a^j \ (mod \ n)\\) 当且仅当 \\(i \equiv j ( mod \ ord_{n}a)\\),其中\\(i\\)和\\(j\\)是非负整数。        

结合**定理4.1**的结论，假设\\(p\\)是一个素数，  \\(\varphi(p)=p-1\\) ,所以可以通过计算\\(p-1\\)的因子，寻找\\(n\\)的阶，且其中必有素数,也就是计算 \\(\varphi(p)=p-1\\) 的素除数。   
所以计算\\(的阶\\)也就是计算\\(p-1\\)的因子。        
> ####阶为\\(p-1\\)本身,即存在\\(p\\)的原根\\(a\\)使得。 \\(\varphi(p)=p-1=ord_{p}a\\)         
> ####阶为\\(q, \ \ q<p-1\\)，\\(q\\)是\\(p-1\\)的一个真因子(且必有素因子)，存在\\(b\\)使得 \\(q=ord_{p}b\\),此时由\\(b\\)生成了一个大小为\\(q\\)的集合。  



根据以上两种情况可以有如下推论:    

**推论4.2.1**  如果整数\\(a\\)是素数\\(p\\)的一个原根，那么\\(a^i \equiv a^j \ (mod \ p) \\) 当且仅当 \\(i \equiv j \ (mod \varphi(p))\\),其中\\(i\\)和\\(j\\)是非负整数。  

**推论4.2.2**  如果阶为\\(q\\)，\\(q\\)是\\(p-1\\)的一个真因子， \\(q=ord_{p}b\\)，那么\\(b^i \equiv b^j \ (mod \ p) \\) 当且仅当 \\(i \equiv j \ (mod \ q)\\),其中\\(i\\)和\\(j\\)是非负整数。   


上面两个推论即分别为`Elgama签名算法`和`DSA签名算法`生成步骤和证明的一个关键所在。

        
        
数论知识介绍到这里，足以推导出后面的`Elgama签名算法`和`DSA签名算法`。

****

## 5. Elgama签名算法   
****
## 6. DSA签名算法 
****
## 7. openssl实例
****
   
**举例说明**

>\\(令a = 4， m = 9，满足(a,m)=1且\varphi(9)=6\\)       
>此时有
>\\(a^{\varphi(m)} =4^{6}=4096 \equiv 1(mod \ 9)\\)


可以利用欧拉定理来找寻模m的逆，若\\(a\\)和\\(m\\)互素则，
$$a \cdot a^{\varphi(m)-1}=a^{\varphi(m)}\equiv 1(mod\ m)$$
因此，\\(a^{\varphi(m)-1}\\) 是\\(a\\)模\\(m\\)的逆。

**举例说明**
> 
> \\(7x \equiv 1(mod\ 10)，求x\\)    
> \\(令a=7，m=10，此时有(a,m)=1，\varphi(m)=\varphi(10)=4，所以\\)    
> \\(7模10的逆为7^{\varphi(10)-1}=7^{3}=343\equiv 3(mod\ 10)\\)    
> \\(所以7模10的逆x\equiv 3(mod10)\\)

**结论** 结合模的逆和欧拉定理,我们有如下结论    
> \\(若a\_{1},a\_{2}...a\_{k}...是a模m的逆，则有\\)
> \\(a^{\varphi(m)-1}\equiv \overline{a}\equiv a^{-1}\equiv a\_{1} \equiv a\_{2}\equiv...\equiv a\_{k}\equiv...(mod\ m)\\)
> \\(而且只有与\overline{a}模m同余的这些整数才是a模m的逆\\)

后面我们统一用\\(\overline{a}\\)记为\\(a模m\\)的逆。 

   
 

### <li>欧拉函数的性质  
**定理** 
\\(如果p是素数，那么\varphi(p)=p-1.反之，如果p是正整数且满足\varphi(p)=p-1，那么p是素数.\\)
> 根据欧拉函数的定义，这个是显然的.    

**定理**
\\(设m和n是互素的正整数，即(m,n)=1，那么\varphi(mn)=\varphi(m)\varphi(n)\\)

###<li> 费马小定理
**注**：书籍上会先引进并证明_费马小定理_，然后再证明_欧拉定理_，这里把_费马小定理_看成_欧拉定理_的特殊情况来证明。   
_**费马小定理**_在证明_**RSA算法**_的其中一种情况时用到。    
**定理(费马小定理)**  \\(设p是一个素数，a是一个正整数且(a,p)=1，则a^{p-1} \equiv 1(mod \ p)\\)    
> **证明**     
> \\(因为p是素数，所以有\varphi(p)=p-1\\)    
> 根据欧拉定理     
> $$a^{p-1} = a^{\varphi(p)}\equiv 1(mod\ p)$$
> 所以    
> $$a^{p-1}  \equiv 1(mod\ p)$$
> 
 

###<li> 辅助定理
此定理可以在不引入中国剩余定理的情况下证明RSA算法的特殊情形.   
定理为《初等数论及其应用》中的推论4.9.1 的一中特殊情况。   
**定理**  \\(若a\equiv b(mod \ m\_1), a\equiv b(mod\ m\_2)， 其中a，b是整数，（m\_1,m\_2）=1, 则\\)  
$$a\equiv b(mod \  m\_1m\_2)$$  
   


</ol>   <!---跟三级标题匹配--> 

